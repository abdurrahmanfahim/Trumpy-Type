<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Typing Test</title>
    <style>
        :root {
            --bg-color: #232427;
            --primary-color: #323437;
            --text-color: #e2b714;
            --correct-color: #43a047;
            --incorrect-color: #e91e63;
            --inactive-color: #646669;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto Mono', monospace;
        }

        body {
            background-color: var(--bg-color);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
        }

        .header {
            width: 100%;
            max-width: 1000px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .settings {
            display: flex;
            gap: 1rem;
        }

        .setting-btn {
            background: var(--primary-color);
            color: var(--text-color);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        .type-container {
            width: 100%;
            max-width: 1000px;
            background: var(--primary-color);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            position: relative;
        }

        .words {
            font-size: 1.5rem;
            line-height: 1.5;
            color: var(--inactive-color);
        }

        .word {
            margin-right: 8px;
            display: inline-block;
        }

        .letter {
            display: inline-block;
            position: relative;
        }

        .letter.correct {
            color: var(--correct-color);
        }

        .letter.incorrect {
            color: var(--incorrect-color);
            background-color: rgba(233, 30, 99, 0.2);
            border-radius: 2px;
        }

        .letter.active {
            animation: blink 1s infinite;
        }

        .cursor {
            position: absolute;
            width: 2px;
            height: 1.5em;
            background-color: var(--text-color);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .stats {
            display: flex;
            gap: 2rem;
            justify-content: center;
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--primary-color);
            padding: 1rem 2rem;
            border-radius: 10px;
            min-width: 150px;
        }

        .stat-value {
            color: var(--text-color);
            font-size: 2rem;
            font-weight: bold;
        }

        .stat-label {
            color: var(--inactive-color);
            margin-top: 0.5rem;
        }

        .restart-btn {
            background: var(--text-color);
            color: var(--bg-color);
            border: none;
            padding: 1rem 2rem;
            border-radius: 5px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.3s;
        }

        .restart-btn:hover {
            transform: scale(1.05);
        }

        .result-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary-color);
            padding: 2rem;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
        }

        .result-modal.active {
            display: block;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Advanced Typing Test</h1>
        <div class="settings">
            <button class="setting-btn" id="timeSelect">Time: 30s</button>
            <button class="setting-btn" id="themeSelect">Theme</button>
            <button class="setting-btn" id="modeSelect">Mode: Words</button>
        </div>
    </div>

    <div class="type-container">
        <div class="words" id="words"></div>
        <div class="cursor" id="cursor"></div>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="stat-value" id="wpm">0</div>
            <div class="stat-label">WPM</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="accuracy">100</div>
            <div class="stat-label">Accuracy</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="timer">30</div>
            <div class="stat-label">Time</div>
        </div>
    </div>

    <button class="restart-btn" id="restart">Restart Test</button>

    <div class="overlay" id="overlay"></div>
    <div class="result-modal" id="resultModal">
        <h2>Test Complete!</h2>
        <div class="final-stats"></div>
        <button class="restart-btn" onclick="typingTest.restart()">Try Again</button>
    </div>

    <script>
        class TypingTest {
            constructor() {
                this.words = [];
                this.currentWordIndex = 0;
                this.currentLetterIndex = 0;
                this.correctLetters = 0;
                this.totalLetters = 0;
                this.isActive = false;
                this.timeLeft = 30;
                
                this.initializeElements();
                this.loadWords();
                this.bindEvents();
                this.generateTest();
            }

            initializeElements() {
                this.wordsContainer = document.getElementById('words');
                this.wpmElement = document.getElementById('wpm');
                this.accuracyElement = document.getElementById('accuracy');
                this.timerElement = document.getElementById('timer');
                this.cursor = document.getElementById('cursor');
                this.resultModal = document.getElementById('resultModal');
                this.overlay = document.getElementById('overlay');
            }

            loadWords() {
                // Extended word list
                this.wordList = [
                    "the", "be", "to", "of", "and", "a", "in", "that", "have", "I",
                    "it", "for", "not", "on", "with", "he", "as", "you", "do", "at",
                    "this", "but", "his", "by", "from", "they", "we", "say", "her", "she",
                    "or", "an", "will", "my", "one", "all", "would", "there", "their", "what",
                    "so", "up", "out", "if", "about", "who", "get", "which", "go", "me"
                ];
            }

            generateTest() {
                this.words = [];
                this.wordsContainer.innerHTML = '';
                
                // Generate random words
                for (let i = 0; i < 50; i++) {
                    const randomWord = this.wordList[Math.floor(Math.random() * this.wordList.length)];
                    this.words.push(randomWord);
                    
                    const wordElement = document.createElement('div');
                    wordElement.className = 'word';
                    
                    // Create spans for each letter
                    [...randomWord].forEach(letter => {
                        const letterSpan = document.createElement('span');
                        letterSpan.className = 'letter';
                        letterSpan.textContent = letter;
                        wordElement.appendChild(letterSpan);
                    });
                    
                    this.wordsContainer.appendChild(wordElement);
                }

                this.updateCursor();
            }

            updateCursor() {
                const currentWord = this.wordsContainer.children[this.currentWordIndex];
                if (currentWord) {
                    const letters = currentWord.children;
                    if (letters[this.currentLetterIndex]) {
                        const letter = letters[this.currentLetterIndex];
                        const rect = letter.getBoundingClientRect();
                        const containerRect = this.wordsContainer.getBoundingClientRect();
                        
                        this.cursor.style.left = `${rect.left - containerRect.left}px`;
                        this.cursor.style.top = `${rect.top - containerRect.top}px`;
                    }
                }
            }

            checkLetter(key) {
                const currentWord = this.wordsContainer.children[this.currentWordIndex];
                if (!currentWord) return;

                const letters = currentWord.children;
                if (this.currentLetterIndex < letters.length) {
                    const currentLetter = letters[this.currentLetterIndex];
                    const isCorrect = key === currentLetter.textContent;
                    
                    currentLetter.classList.add(isCorrect ? 'correct' : 'incorrect');
                    this.currentLetterIndex++;
                    this.totalLetters++;
                    if (isCorrect) this.correctLetters++;
                    
                    this.updateStats();
                    this.updateCursor();
                }

                // Move to next word if space is pressed and we're at the end of the word
                if (key === ' ' && this.currentLetterIndex >= letters.length) {
                    this.currentWordIndex++;
                    this.currentLetterIndex = 0;
                    this.updateCursor();
                }
            }

            updateStats() {
                const timeElapsed = (30 - this.timeLeft) / 60;
                const wpm = Math.round((this.correctLetters / 5) / timeElapsed) || 0;
                const accuracy = Math.round((this.correctLetters / this.totalLetters) * 100) || 100;

                this.wpmElement.textContent = wpm;
                this.accuracyElement.textContent = accuracy;
            }

            startTimer() {
                this.timerInterval = setInterval(() => {
                    this.timeLeft--;
                    this.timerElement.textContent = this.timeLeft;
                    
                    if (this.timeLeft <= 0) {
                        this.endTest();
                    }
                }, 1000);
            }

            endTest() {
                clearInterval(this.timerInterval);
                this.isActive = false;
                this.showResults();
            }

            showResults() {
                const finalWpm = this.wpmElement.textContent;
                const finalAccuracy = this.accuracyElement.textContent;
                
                this.resultModal.querySelector('.final-stats').innerHTML = `
                    <h3>WPM: ${finalWpm}</h3>
                    <h3>Accuracy: ${finalAccuracy}%</h3>
                `;
                
                this.resultModal.classList.add('active');
                this.overlay.classList.add('active');
            }

            restart() {
                this.currentWordIndex = 0;
                this.currentLetterIndex = 0;
                this.correctLetters = 0;
                this.totalLetters = 0;
                this.timeLeft = 30;
                this.isActive = false;
                
                clearInterval(this.timerInterval);
                this.timerElement.textContent = this.timeLeft;
                this.wpmElement.textContent = '0';
                this.accuracyElement.textContent = '100';
                
                this.resultModal.classList.remove('active');
                this.overlay.classList.remove('active');
                
                this.generateTest();
            }

            bindEvents() {
                document.addEventListener('keydown', (e) => {
                    if (!this.isActive && e.key.length === 1) {
                        this.isActive = true;
                        this.startTimer();
                    }

                    if (this.isActive && !e.ctrlKey && !e.altKey) {
                        if (e.key.length === 1 || e.key === ' ') {
                            e.preventDefault();
                            this.checkLetter(e.key);
                        }
                    }
                });

                document.getElementById('restart').addEventListener('click', () => this.restart());
            }
        }

        // Initialize the typing test
        const typingTest = new TypingTest();
    </script>
</body>
</html>
